"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34726],{121758:function(e,t,s){s.d(t,{w:function(){return x}});var a=s(381119),i=s(567222),n=s(84505),r=s(109664),o=s(284420),l=s(436279),d=s(974273),c=s(385909),m=s.n(c),g=s(752406),u=s(609011),y=s(865723),p=s(330567);const h=m()((()=>Promise.all([s.e(69902),s.e(30848),s.e(95158),s.e(87526)]).then(s.bind(s,802152))),{ssr:!1,loading:()=>(0,p.jsx)(o.Z,{}),loadableGenerated:{webpack:()=>[802152]}}),x=e=>{let{analyticsDetails:t,itemDetails:s,setError:o}=e;const{0:c,1:m}=(0,g.useState)(!1),x=(0,g.useRef)(null),[L,{error:b,isLoading:R}]=(0,a.Z)(t);(0,g.useEffect)((()=>{b&&"LSE-4054"!==b.name&&o({message:b.message,type:"addToList"})}),[b,o]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i.ZP,{alternateObservationPoint:x,moduleContext:t.context,name:t.analyticsName,pageTitle:t.pageTitle,shouldSuppressModuleView:!0,children:(0,p.jsxs)(d.C,{onClick:()=>{o({message:"",type:"addToList"}),m(!0)},onLinkName:t.analyticsName,onLinkExtras:t.addItemsLabelClick(),children:[(0,p.jsx)(l.J,{"aria-hidden":!0,className:"mr3",name:"Heart",style:{width:"16px"}}),(0,n.m)(u,"addList")]})}),(0,p.jsx)(y.e,{isOpen:c,setIsOpen:m,onSaveClick:e=>{let{setPage:t=r.Z,selectedList:a,toggleOpen:i=r.Z}=e;a&&(L({input:{items:[s],listId:a.id},name:a.name,type:a.type,ownerName:a.ownerName,showPrimary:a.showPrimary,maxItemsReached:!!a.maxItemsReached,setPage:t,toggleOpen:i,handleError:()=>i(!1)}),a.maxItemsReached||i())},isSaving:R,analyticsDetails:t,createListPage:e=>{let{onWrappedClose:t}=e;return(0,p.jsx)(h,{itemDetails:s,onWrappedClose:t,setError:o})}})]})}},259053:function(e,t,s){s.d(t,{d:function(){return _}});var a=s(494406),i=s(739333),n=s(567222),r=s(84505),o=s(869193),l=s(272374),d=s(975111),c=s(870751),m=s(855124),g=s(35968),u=s(181739),y=s(597893),p=s(719424),h=s(932306),x=s(271762);const L={type:"query",name:"getRegistries",query:"query getRegistries{registries{id name type itemCount recentItem{product{name imageInfo{thumbnailUrl allImages{url}}}secondaryProduct{imageWhenAdded}}eventDate maxItemsReached}}",hash:"78bdb638256537f036ca2fc5b7201cbef4715b39fa701562f52d56ea4e17a169"};var b=s(157051);var R=()=>{var e;const t=(0,m.Z)(),{isMobile:s}=(0,o.vP)(),{timeoutMs:a,loggingEnable:i}=(null==(e=(0,c.iC)(b.g).registry)?void 0:e.values)||{},n=((e,t)=>{let{timeoutMs:s,loggingEnable:a,isMobile:i}=t;return{queryFn:()=>(0,x.u)(e.getGqlFetch((0,u.d)(i),{timeoutMs:s})(L),h.ZP).then((e=>{const t=e.errors;return(0,p.jg)({apiName:"shoppingLists",queryKey:[y.vf,"add-items"],additionalTags:[t&&t.length?p.Hi.TAGS.GQL_CALL_FAILURE:p.Hi.TAGS.GQL_CALL_SUCCESS],errors:t,loggingEnable:a}),e})),queryKey:[y.vf,"add-items"]}})(t,{isMobile:s,timeoutMs:a,loggingEnable:i}),{data:r,error:l,isFetching:d,isLoading:R,isStale:I,refetch:C,isSuccess:S}=(0,g.aM)({...n,config:{enabled:!1,refetchOnWindowFocus:!1,staleTime:1/0}}),f=(null==r?void 0:r.data)||[],T=!(null==r||!r.errors)||!!l;return{isFetchError:T,lists:f,isSuccess:S,refetch:()=>{(I||T)&&C()},showSpinner:d||R}},I=s(752406),C=s(454684);var S=(e,t)=>{const[s,{error:a,isLoading:i}]=(0,C.Z)(e),{0:n,1:r}=(0,I.useState)(!1),{0:o,1:l}=(0,I.useState)(!1),{0:d,1:c}=(0,I.useState)({id:"",name:"",type:"",ownerName:"",maxItemsReached:!1});(0,I.useEffect)((()=>{a&&"LSE-4057"!==a.name&&t({message:"Sorry, something went wrong. Try again later.",type:"addToRegistry"})}),[a,t]);return{isLoading:i,isOpen:o,onExit:()=>{l(!o),r(!1)},saveItemToRegistry:s,selectList:c,selectedList:d,setIsOpen:l,setShouldToggle:r,shouldToggle:n}},f=s(715963),T=s(536486),E=s(194605),v=s(284420),w=s(436279),k=s(974273),P=s(407469),j=s(385909),M=s.n(j),Z=s(609011),N=s(330567);const G={[d.Yo.WEDDING]:"/registry/WR/create",[d.Yo.EVENT]:"/registry/ER/create",[d.Yo.RISE]:"/registry/RR/create",[d.Yo.BABY]:"/registry/BR/create"},F=M()((()=>Promise.all([s.e(69902),s.e(11717)]).then(s.bind(s,483161))),{ssr:!1,loading:()=>(0,N.jsx)(v.Z,{}),loadableGenerated:{webpack:()=>[483161]}}),A=M()((async()=>(await Promise.all([s.e(69902),s.e(90071)]).then(s.bind(s,162722))).RegistryTypeSelector),{ssr:!1,loading:()=>(0,N.jsx)(v.Z,{}),loadableGenerated:{webpack:()=>[162722]}}),D=M()((async()=>(await Promise.all([s.e(69902),s.e(49774),s.e(91540),s.e(64622),s.e(53246),s.e(66789),s.e(30848),s.e(17123),s.e(89475),s.e(68800)]).then(s.bind(s,579846))).MaxLimitPage),{ssr:!1,loading:()=>(0,N.jsx)(v.Z,{}),loadableGenerated:{webpack:()=>[579846]}}),q=e=>e?{backButton:"dn"}:{backButton:"dn",titleCont:"ml2-m",title:"tl-m"},_=e=>{let{analyticsDetails:t,itemDetails:s,setError:d}=e;const{router:c}=(0,l.t)(),{0:m,1:g}=(0,I.useState)(!1),{isFetchError:u,lists:y,refetch:p,showSpinner:h,isSuccess:x}=R(),L=(0,I.useRef)(!1),b=(0,I.useRef)(!1),C=(0,a.Z)(),{isLoading:j,isOpen:M,onExit:_,saveItemToRegistry:O,selectList:K,selectedList:B,setShouldToggle:W,shouldToggle:Q}=S(t,d),U=(0,I.useRef)(B.id);(0,I.useEffect)((()=>{C&&(L.current=C)}),[C,B]),(0,I.useEffect)((()=>{U.current!==B.id&&L.current&&(b.current=!0)}),[U,B]),(0,I.useEffect)((()=>{!B.id&&y.length&&K(y[0])}),[y,B.id]);const{isMobile:V}=(0,o.vP)();Q&&!h&&_();const H=e=>{const t=G[e],a=new URLSearchParams({usItemId:s.usItemId,itemType:s.itemType}).toString();g(!0),W(!0);const i=t+"?"+a;c.push(i)},Y=x&&!u&&!y.length,z={addItemToRegistryPageContentKey:{pageTitle:(0,r.m)(Z,"addItemReg"),component:e=>{let{setPage:a}=e;return(0,N.jsx)(F,{analyticsDetails:t,allowRadioNav:!L.current||b.current,isFetchError:u,lists:y,showSpinner:h,selectedList:B,selectList:K,setPage:a,usItemId:s.usItemId})},titleCustomClass:q(V)},createRegistryContentKey:{pageTitle:(0,r.m)(Z,"createReg"),component:()=>(0,N.jsx)(A,{heading:(0,r.m)(Z,"whatReg"),showTypeDescriptions:!0,onClick:H}),titleCustomClass:{backButton:"pointer"}},maxItemLimitContentKey:{pageTitle:(0,r.m)(Z,"itemRegError"),component:e=>{let{onWrappedClose:t}=e;return(0,N.jsx)(D,{maxModalMessage:(0,r.m)(Z,"maxRegItems"),onWrappedClose:t})},titleCustomClass:{backButton:"pointer",title:"f3"}}};return(0,N.jsxs)(N.Fragment,{children:[(h||m)&&(0,N.jsx)(v.Z,{}),(0,N.jsx)(n.ZP,{moduleContext:t.context,name:t.analyticsName,pageTitle:t.pageTitle,shouldSuppressModuleView:!0,children:(0,N.jsxs)(k.C,{onClick:()=>{p(),W(!0)},onLinkName:t.analyticsName,onLinkExtras:t.addItemsLabelClick(),children:[(0,N.jsx)(w.J,{"aria-hidden":!0,className:"mr3",name:"Gift",style:{width:"16px"}}),(0,r.m)(Z,"addReg")]})}),(0,N.jsxs)(T.Z,{children:[Y&&(0,N.jsx)(E.Z,{title:(0,r.m)(Z,"createReg"),position:"right",size:"large",isOpen:M&&!h,onClose:()=>W(!0),children:(0,N.jsx)(A,{heading:(0,r.m)(Z,"createRegistryNoRegistry"),showTypeDescriptions:!0,onClick:H,includeLearnMore:!0})}),!Y&&(0,N.jsx)(P.Z,{pageScope:z,isOpen:M&&!h,showTransitionGradient:!1,initialPage:"addItemToRegistryPageContentKey",onClose:()=>W(!0),getSize:e=>"createRegistryContentKey"===e?"large":"small",getActionButton:(e,a)=>"addItemToRegistryPageContentKey"===a&&!u&&(0,N.jsx)(f.Z,{isFullWidth:!0,onClick:()=>{O({input:{items:[s],registryId:B.id,registryType:B.type},name:B.name,maxItemsReached:!!B.maxItemsReached,setPage:e,setShouldToggle:W}),B.maxItemsReached||W(!0)},onLinkExtras:t.onListSelect(B),onLinkName:"save",size:"medium",variant:"primary",disabled:B.maxItemsReached&&j,leading:B.maxItemsReached&&j&&(0,N.jsx)(i.Spinner,{color:"white",size:"small",a11yLabel:(0,r.m)(Z,"savingList")}),children:(0,r.m)(Z,"save")})})]})]})}},454684:function(e,t,s){s.d(t,{Z:function(){return h}});var a=s(739333),i=s(870751),n=s(869193),r=s(147584),o=s(35968),l=s(855124),d=s(272374),c=s(109664),m=s(597893),g=s(181739),u=s(719424);const y={type:"mutation",name:"addItemToRegistryLite",query:"mutation addItemToRegistryLite($input:RegistryItemInputLite!){addItemToRegistryLite(input:$input){id}}",hash:"a961f4eb202d8d414fd4a677bed81aa6deb73bd6f650971abcf8ca98ef1b3279"};var p=s(157051);var h=function(e,t,s){var h;void 0===t&&(t=!0),void 0===s&&(s=!0);const x=(0,o.Zq)(),L=(0,l.Z)(),{router:b}=(0,d.t)(),R=(0,r.wG)(),{addSnack:I}=(0,a.useSnackbar)(),{isMobile:C}=(0,n.vP)(),{timeoutMs:S,loggingEnable:f}=(null==(h=(0,i.iC)(p.g).registry)?void 0:h.values)||{},{mutationFn:T}=((e,t)=>{let{timeoutMs:s,loggingEnable:a,isMobile:i}=t;return{mutationFn:t=>e.getGqlFetch((0,g.d)(i),{timeoutMs:s})(y,t).then((e=>{const s=e.errors;if((0,u.jg)({apiName:"addItemToRegistryLite",gqlVariables:t,additionalTags:[s&&s.length?u.Hi.TAGS.GQL_CALL_FAILURE:u.Hi.TAGS.GQL_CALL_SUCCESS],errors:s,loggingEnable:a}),s){const e=new Error("Sorry, something went wrong. Try again later.");return e.name=s[0].extensions&&s[0].extensions.code||"Non GQL Error",Promise.reject(e)}return e}))}})(L,{isMobile:C,timeoutMs:S,loggingEnable:f});return(0,o.Db)(T,{onSuccess:(a,i)=>{let{input:{registryType:n,registryId:r},name:o,maxItemsReached:l,setShouldToggle:d=c.Z,reFetchDetailsPage:g=!0}=i;l&&d(!0),x.invalidateQueries(m.vf),g&&x.invalidateQueries(m.gr);const u={name:o,type:n,id:r};if(s){const t=e.addItemsSuccess(u);R({context:e.context,action:"moduleView",name:"addedToRegistry",payload:t})}t&&I({message:'Saved to "'+o+'"',actionButtonProps:{children:"View registry",onClick:()=>{const t=e.viewClick(u);R({context:e.context,action:"onLink",name:"viewRegistry",payload:t}),b.push("/registry/"+n+"/"+r)}}})},onError:(e,t)=>{let{setPage:s=c.Z,openMaxItemModal:a=c.Z}=t;"LSE-4057"===e.name?(s("maxItemLimitContentKey"),a()):b.query.type&&s("errorAddItemContentKey")}})}}}]);